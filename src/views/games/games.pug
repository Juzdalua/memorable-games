extends ../layouts/base.pug
include ../mixins/comment-mixin.pug

block content 
    div.notice__main 
        div.notice__main-header
            span=game.owner.userid 
            span
                =game.createAt.toISOString().substr(0,10)+" "+String(game.createAt.getHours()).padStart(2, '0')+":"+String(game.createAt.getMinutes()).padStart(2, '0')+":"+String(game.createAt.getSeconds()).padStart(2, '0')
            span ì¡°íšŒ: #{game.views}
        div.notice__main-header__menu
            div
                case game.genre
                    when 0
                        span [ì•¡ì…˜]
                    when 1
                        span [RPG]
                    when 2
                        span [í¼ì¦]
                    when 3
                        span [ì–´ë“œë²¤ì³]
                    when 4
                        span [ì‹œë®¬ë ˆì´ì…˜]
                    when 5
                        span [ìŒì•…]
                    when 6
                        span [ìŠ¤í¬ì¸ ]
                    when 7
                        span [ì•„ì¼€ì´ë“œ]            
                span  | 
                case game.age
                    when 0
                        span [ì „ì²´ì´ìš©ê°€]
                    when 1
                        span [12ì„¸ì´ìš©ê°€]
                    when 2
                        span [15ì„¸ì´ìš©ê°€]
                    when 3
                        span [ì²­ì†Œë…„ì´ìš©ë¶ˆê°€]
                    when 4
                        span [ì‹œí—˜ìš©]
                    when 5
                        span [ë“±ê¸‰ë©´ì œ]
            div
                if loggedInUser._id === String(game.owner._id)
                    a(href=`/games/${game._id}/modify`) ìˆ˜ì • 
                    span | 
                    a(href=`/games/${game._id}/delete`) ì‚­ì œ                
                    span | 
                a(href="/games") ëª©ë¡ 
                span | ëŒ“ê¸€(#{game.comments.length})
        div.notice__main-content
            span.notice__main-content__title=game.title    
            if game.thumbnailUrl 
                if isHeroku
                    img.article__main-content__img(src=`${game.thumbnailUrl}` alt="")
                else 
                    img.article__main-content__img(src=`/${game.thumbnailUrl}` alt="")
            if game.fileUrl
                if !isHeroku
                    video.steam__main-content__video(controls src=`/${game.fileUrl}`)
                else 
                    video.steam__main-content__video(controls src=`${game.fileUrl}`)            
            span.notice__main-content__main(style="white-space:pre;")=game.description
            div.steam__main-rating
                div.steam__main-rating__like
                    span.steam__main-rating-like(OnClick=`location.href="/games/${game._id}/like"`) ğŸ‘
                    span.steam__main-rating-rate=game.like.like
                iv.steam__main-rating__dislike
                    span.steam__main-rating-dislike(OnClick=`location.href="/games/${game._id}/dislike"`) ğŸ‘
                    span.steam__main-rating-rate=game.dislike.dislike

    div.steam__main-comment
        div.steam__main-comment__count
            i.far.fa-comment
            span.steam__main-comment__count-comments ëŒ“ê¸€(#{game.comments.length})        
        div.steam__main-comment__item
            each comment in comments 
                +comment(comment)
            else 
                span ì•„ì§ ì‘ì„±ëœ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. 
        div.steam__main-comment__form
            form.steam__main-comment__form-container(action=`/api/games/${game._id}/comment` method="POST")
                div.steam__main-comment__form-container__text
                    textarea(rows="3" name="comment")
                div.steam__main-comment__form-container__submit
                    input(type="submit" value="ë“±ë¡")
              
    if errorMessage
        script.         
            alert(`#{errorMessage}`)

    